import{i as E,r as c,k as T,l as P,n as N,p as d,h,f as r,C as O,B as R}from"./index.292757b7.js";import{c as B,a as p,u as C,K as m,b as q,A,d as F}from"./useAuthenticationServices.28575415.js";import{B as w}from"./Banner.78033cf6.js";import{N as I}from"./chunk-2.6c33ca0b.js";import"./encryptDecrypt.03cbd913.js";const{useClasses:k}=E(),G=()=>{const g={},a=k(),[s,i]=c.exports.useState(["mobile"]);c.exports.useRef(null);const{login:z,signup:$,userExist:D,sendOtp:L,verifyOtp:b,resetPin:f}=F();T(),P();const l=N(e=>e.auth),y=B().shape({mobile:p().min(10,d).max(10,d).matches(/^[6-9]\d{9}$/,"Please enter valid mobile").required("Required"),pin:p().min(4,"Enter atleast 4 digit pin").max(8,"Pin should be between 4 and 8 digits").matches(/^\d+$/,"Please enter only numeric pin").required("Required"),otp:p().min(4,"Enter atleast 4 digit OTP").max(4,"OTP should be 4 digits").matches(/^\d+$/,"Enter correct OTP").required("Required")}),t=C({initialValues:{mobile:"",pin:"",otp:""},validationSchema:y,onSubmit:async e=>{try{let n={phone:e.mobile.toString(),pin:e.pin.toString()};const o=await f(n);o.status===200?console.log("Success"):o.status===400||o.status===404?console.log("Error - 400"):console.log("Error")}catch(n){console.log("Reset PIN Error - ",n)}}}),v=async(e,n)=>{try{let o={phone:e.toString(),otp:n.toString()};const u=await b(o);if(u.status===200)return!0;if(u.status===400&&u.data.message==="Error while sending OTP")return!1}catch(o){console.log("OTP Sending Error - ",o)}},x=async e=>{t.handleChange(e);const n=e.target.value;n.length===4?await v(t.values.mobile,n)&&i([...s,"pin"]):i(["mobile","otp"])},S=e=>{t.handleChange(e),e.target.value.length>=4&&e.target.value.length<=8?i([...s,"submit-btn"]):i(["mobile","otp","pin"])};return c.exports.useEffect(()=>{(async()=>{l.userAuthInfo.phoneNumber&&(t.setFieldValue("mobile",l.userAuthInfo.phoneNumber),i(["mobile","otp"]))})()},[l.userAuthInfo.phoneNumber]),h("div",{style:g,children:[r(w,{}),r("form",{onSubmit:t.handleSubmit,children:h("div",{style:{padding:"20px"},children:[s.includes("mobile")&&r("div",{children:r(m,{name:"mobile",placeholder:"Enter your mobile number",required:!0,size:"large",type:"number",contentBefore:r(O,{className:a["primary-icon"]}),value:t.values.mobile,onChange:e=>{t.handleChange(e)},onInput:e=>{t.setFieldTouched("mobile",!0)},helperText:t.touched.mobile&&t.errors.mobile?t.errors.mobile:null,style:{marginBottom:"26px"}})}),s.includes("otp")&&r("div",{children:r(m,{name:"otp",placeholder:"Enter OTP sent to your number",required:!0,size:"large",type:"number",contentBefore:r(I,{className:a["primary-icon"]}),value:t.values.otp,onChange:e=>x(e),onInput:e=>t.setFieldTouched("otp",!0),helperText:t.touched.otp&&t.errors.otp?t.errors.otp:null,style:{marginBottom:"26px"}})}),s.includes("pin")&&r("div",{children:r(m,{name:"pin",placeholder:"Enter your pin number",required:!0,size:"large",type:"password",contentBefore:r(q,{className:a["primary-icon"]}),value:t.values.pin,onChange:e=>S(e),onInput:e=>t.setFieldTouched("pin",!0),helperText:t.touched.pin&&t.errors.pin?t.errors.pin:null,style:{marginBottom:"26px"}})}),s.includes("submit-btn")&&r("div",{children:r(R,{type:"submit",shape:"circular",appearance:"primary",size:"large",style:{marginTop:"26px",textAlign:"center",display:"block",marginLeft:"auto",marginRight:"auto",border:"none",zoom:"150%",backgroundColor:"transparent"},children:r(A,{className:a["secondary-icon"]})})})]})})]})};export{G as default};
