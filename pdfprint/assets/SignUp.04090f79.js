import{i as B,r as p,k as F,l as R,n as I,p as g,h as b,f as n,C as k,V as z,B as $,x as D}from"./index.292757b7.js";import{c as L,a as u,u as M,K as c,b as U,A as V,d as _}from"./useAuthenticationServices.28575415.js";import{B as j}from"./Banner.78033cf6.js";import{N as K}from"./chunk-2.6c33ca0b.js";import"./encryptDecrypt.03cbd913.js";const{useClasses:G}=B(),Y=()=>{const f={},i=G(),[o,a]=p.exports.useState(["mobile"]),d=p.exports.useRef(null),{login:H,signup:y,userExist:N,sendOtp:v,verifyOtp:x}=_(),S=F(),E=R(),l=I(e=>e.auth),T=L().shape({mobile:u().min(10,g).max(10,g).matches(/^[6-9]\d{9}$/,"Please enter valid mobile").required("Required"),pin:u().min(4,"Enter atleast 4 digit pin").max(8,"Pin should be between 4 and 8 digits").matches(/^\d+$/,"Please enter only numeric pin").required("Required"),otp:u().min(4,"Enter atleast 4 digit OTP").max(4,"OTP should be 4 digits").matches(/^\d+$/,"Enter correct OTP").required("Required"),customerName:u().min(2,"Enter Full Name").max(128,"Name should be under 128 characters").matches(/^[A-Za-z\s]+$/,"Please enter correct name with alphabets and spaces").required("Required")}),t=M({initialValues:{mobile:"",pin:"",otp:"",customerName:""},validationSchema:T,onSubmit:async e=>{try{let r={phone:e.mobile.toString(),pin:e.pin.toString(),otp:e.otp.toString(),customerName:e.customerName.toString()};const s=await y(r);s.status===200?console.log("Success"):s.status===400||s.status===404?console.log("Error - 400"):console.log("Error")}catch(r){console.log("Login Error - ",r)}}}),w=async e=>{try{let r={phone:e.toString()};const s=await N(r);if(s.status===200)return!0;if(s.status===400&&s.data.message==="Account not verified")return!1;if(s.status===404&&s.data.message==="Account not found")return!1}catch(r){console.log("Account Check Error - ",r)}},h=async e=>{try{let r={phone:e.toString(),isExistingUser:!1};const s=await v(r);if(s.status===200)return!0;if(s.status===400&&s.data.message==="Error while sending OTP")return!1}catch(r){console.log("OTP Sending Error - ",r)}},O=async(e,r)=>{try{let s={phone:e.toString(),otp:r.toString()};const m=await x(s);if(m.status===200)return!0;if(m.status===400&&m.data.message==="Error while sending OTP")return!1}catch(s){console.log("OTP Sending Error - ",s)}},q=async e=>{const r=e.target.value;r.length===10&&(await w(r)?(a([...o,"pin"]),E(D(e.target.value.toString())),S("/login")):(a(["mobile","otp"]),await h(r)))},A=async e=>{t.handleChange(e);const r=e.target.value;r.length===4?await O(t.values.mobile,r)&&a([...o,"pin"]):a(["mobile","otp"])},P=e=>{t.handleChange(e),e.target.value.length>=4&&e.target.value.length<=8?a([...o,"customerName"]):a(["mobile","otp","pin"])},C=e=>{t.handleChange(e),e.target.value.length>=4?a([...o,"submit-btn"]):a(["mobile","otp","pin","customerName"])};return p.exports.useEffect(()=>{(async()=>{l.userAuthInfo.phoneNumber&&(t.setFieldValue("mobile",l.userAuthInfo.phoneNumber),a(["mobile","otp"]),await h(l.userAuthInfo.phoneNumber))})()},[l.userAuthInfo.phoneNumber]),b("div",{style:f,children:[n(j,{}),n("form",{onSubmit:t.handleSubmit,children:b("div",{style:{padding:"20px"},children:[o.includes("mobile")&&n("div",{children:n(c,{name:"mobile",placeholder:"Enter your mobile number",required:!0,size:"large",type:"number",contentBefore:n(k,{className:i["primary-icon"]}),value:t.values.mobile,onChange:e=>{t.handleChange(e),clearTimeout(d.current);const r=setTimeout(()=>q(e),500);d.current=r},onInput:e=>{t.setFieldTouched("mobile",!0)},helperText:t.touched.mobile&&t.errors.mobile?t.errors.mobile:null,style:{marginBottom:"26px"}})}),o.includes("otp")&&n("div",{children:n(c,{name:"otp",placeholder:"Enter OTP sent to your number",required:!0,size:"large",type:"number",contentBefore:n(K,{className:i["primary-icon"]}),value:t.values.otp,onChange:e=>A(e),onInput:e=>t.setFieldTouched("otp",!0),helperText:t.touched.otp&&t.errors.otp?t.errors.otp:null,style:{marginBottom:"26px"}})}),o.includes("pin")&&n("div",{children:n(c,{name:"pin",placeholder:"Enter your pin number",required:!0,size:"large",type:"password",contentBefore:n(U,{className:i["primary-icon"]}),value:t.values.pin,onChange:e=>P(e),onInput:e=>t.setFieldTouched("pin",!0),helperText:t.touched.pin&&t.errors.pin?t.errors.pin:null,style:{marginBottom:"26px"}})}),o.includes("customerName")&&n("div",{children:n(c,{name:"customerName",placeholder:"Enter your full name",required:!0,size:"large",contentBefore:n(z,{className:i["primary-icon"]}),value:t.values.customerName,onChange:e=>C(e),onInput:e=>t.setFieldTouched("customerName",!0),helperText:t.touched.customerName&&t.errors.customerName?t.errors.customerName:null,style:{marginBottom:"26px"}})}),o.includes("submit-btn")&&n("div",{children:n($,{type:"submit",shape:"circular",appearance:"primary",size:"large",style:{marginTop:"26px",textAlign:"center",display:"block",marginLeft:"auto",marginRight:"auto",border:"none",zoom:"150%",backgroundColor:"transparent"},children:n(V,{className:i["secondary-icon"]})})})]})})]})};export{Y as default};
